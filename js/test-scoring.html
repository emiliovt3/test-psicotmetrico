<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test del Motor de Calificaci√≥n</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 { color: #333; }
        h2 { color: #066fd1; border-bottom: 2px solid #066fd1; padding-bottom: 5px; }
        h3 { color: #666; }
        
        .test-case {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .resultado {
            background: #fff;
            border: 2px solid #066fd1;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .recomendacion {
            font-size: 24px;
            font-weight: bold;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }
        
        .contratar { background: #d4edda; color: #155724; border: 2px solid #28a745; }
        .rechazado { background: #f8d7da; color: #721c24; border: 2px solid #dc3545; }
        .segunda-entrevista { background: #fff3cd; color: #856404; border: 2px solid #ffc107; }
        
        .disc-profile {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .disc-item {
            text-align: center;
            padding: 10px 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #066fd1;
        }
        
        .disc-item .letra {
            font-size: 32px;
            font-weight: bold;
            color: #066fd1;
        }
        
        .disc-item .valor {
            font-size: 24px;
            margin-top: 5px;
        }
        
        .banderas {
            margin: 20px 0;
        }
        
        .bandera {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            border-left: 4px solid;
        }
        
        .bandera.critica {
            background: #f8d7da;
            color: #721c24;
            border-color: #dc3545;
        }
        
        .bandera.advertencia {
            background: #fff3cd;
            color: #856404;
            border-color: #ffc107;
        }
        
        .bandera.informativa {
            background: #d1ecf1;
            color: #0c5460;
            border-color: #17a2b8;
        }
        
        .puntajes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .puntaje-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .puntaje-item .seccion {
            font-weight: bold;
            color: #666;
            text-transform: uppercase;
            font-size: 12px;
        }
        
        .puntaje-item .valor {
            font-size: 28px;
            color: #066fd1;
            margin: 5px 0;
        }
        
        .puntaje-item .maximo {
            color: #999;
            font-size: 14px;
        }
        
        button {
            background: #066fd1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .insights {
            background: #e7f3ff;
            border: 1px solid #066fd1;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .insights ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .summary-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .summary-item .label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .summary-item .value {
            font-size: 32px;
            font-weight: bold;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test del Motor de Calificaci√≥n Autom√°tica</h1>
        <p>Prueba el motor con diferentes casos para validar el algoritmo de scoring</p>
        
        <div class="test-case">
            <h3>Casos de Prueba Disponibles:</h3>
            <button onclick="probarCandidatoIdeal()">üëç Candidato Ideal (Jos√© Mart√≠nez)</button>
            <button onclick="probarCandidatoDeshonesto()">‚ùå Candidato Deshonesto</button>
            <button onclick="probarCandidatoPromedio()">üìä Candidato Promedio</button>
            <button onclick="probarCandidatoTecnico()">üîß Solo T√©cnico Bueno</button>
            <button onclick="probarDatosReales()">üìã Usar Datos del LocalStorage</button>
        </div>
    </div>

    <div id="resultado" style="display: none;">
        <!-- Aqu√≠ se mostrar√°n los resultados -->
    </div>

    <script src="scoring-engine.js"></script>
    <script>
        // Candidato Ideal - Jos√© Mart√≠nez (ejemplo del documento)
        function probarCandidatoIdeal() {
            const respuestas = {
                cleaver: {
                    1: { mas: 'A', menos: 'C' },
                    2: { mas: 'A', menos: 'C' },
                    3: { mas: 'A', menos: 'D' },
                    4: { mas: 'C', menos: 'B' },
                    5: { mas: 'C', menos: 'D' },
                    6: { mas: 'A', menos: 'D' },
                    7: { mas: 'C', menos: 'B' },
                    8: { mas: 'C', menos: 'D' },
                    9: { mas: 'C', menos: 'B' },
                    10: { mas: 'A', menos: 'D' }
                },
                kostick: {
                    1: 'TA', 2: 'TA', 3: 'A', 4: 'TA', 5: 'TA',
                    6: 'A', 7: 'D', 8: 'TA', 9: 'A', 10: 'TA',
                    11: 'TA', 12: 'A', 13: 'TA', 14: 'A', 15: 'TA'
                },
                situaciones: {
                    1: 'B', // Rechaza trabajo sin factura
                    2: 'B', // Reporta herramienta da√±ada
                    3: 'B', // Rechaza pr√©stamo
                    4: 'B', // No toma material
                    5: 'A'  // Reporta accidente
                },
                aptitudes: {
                    1: '3', 2: '4', 3: '3', 4: '4',
                    5: '3', 6: '3', 7: '4', 8: '3',
                    9: '3', 10: '4', 11: '3', 12: '3'
                }
            };
            
            calcularYMostrar(respuestas, 'Candidato Ideal - Jos√© Mart√≠nez');
        }

        // Candidato Deshonesto - Ser√° rechazado autom√°ticamente
        function probarCandidatoDeshonesto() {
            const respuestas = {
                cleaver: {
                    1: { mas: 'B', menos: 'A' },
                    2: { mas: 'C', menos: 'A' },
                    3: { mas: 'C', menos: 'A' },
                    4: { mas: 'B', menos: 'C' },
                    5: { mas: 'D', menos: 'C' },
                    6: { mas: 'D', menos: 'A' },
                    7: { mas: 'D', menos: 'C' },
                    8: { mas: 'B', menos: 'C' },
                    9: { mas: 'D', menos: 'C' },
                    10: { mas: 'C', menos: 'A' }
                },
                kostick: {
                    1: 'D', 2: 'D', 3: 'TD', 4: 'D', 5: 'TD', // Cr√≠tica: No sigue seguridad
                    6: 'D', 7: 'TA', 8: 'D', 9: 'TD', 10: 'D',
                    11: 'TD', // Cr√≠tica: No ayuda a compa√±eros
                    12: 'TD', 
                    13: 'TD', // Cr√≠tica: No devuelve material
                    14: 'D', 15: 'D'
                },
                situaciones: {
                    1: 'A', // CR√çTICA: Acepta trabajo sin factura
                    2: 'A', // No reporta da√±o
                    3: 'A', // Acepta pr√©stamo
                    4: 'A', // CR√çTICA: Toma material
                    5: 'B'  // No reporta accidente r√°pido
                },
                aptitudes: {
                    1: '1', 2: '0', 3: '1', 4: '1',
                    5: '0', 6: '1', 7: '0', 8: '1',
                    9: '0', 10: '1', 11: '0', 12: '1'
                }
            };
            
            calcularYMostrar(respuestas, 'Candidato Deshonesto - Carlos Ram√≠rez');
        }

        // Candidato Promedio
        function probarCandidatoPromedio() {
            const respuestas = {
                cleaver: {
                    1: { mas: 'B', menos: 'C' },
                    2: { mas: 'A', menos: 'D' },
                    3: { mas: 'B', menos: 'C' },
                    4: { mas: 'A', menos: 'D' },
                    5: { mas: 'B', menos: 'A' },
                    6: { mas: 'C', menos: 'B' },
                    7: { mas: 'A', menos: 'D' },
                    8: { mas: 'B', menos: 'D' },
                    9: { mas: 'A', menos: 'B' },
                    10: { mas: 'C', menos: 'B' }
                },
                kostick: {
                    1: 'A', 2: 'N', 3: 'A', 4: 'N', 5: 'A',
                    6: 'N', 7: 'N', 8: 'A', 9: 'N', 10: 'A',
                    11: 'A', 12: 'N', 13: 'A', 14: 'N', 15: 'A'
                },
                situaciones: {
                    1: 'B', 2: 'B', 3: 'A', 4: 'B', 5: 'A'
                },
                aptitudes: {
                    1: '2', 2: '2', 3: '2', 4: '2',
                    5: '2', 6: '2', 7: '2', 8: '2',
                    9: '2', 10: '2', 11: '2', 12: '2'
                }
            };
            
            calcularYMostrar(respuestas, 'Candidato Promedio');
        }

        // Candidato con buenos conocimientos t√©cnicos pero problemas de actitud
        function probarCandidatoTecnico() {
            const respuestas = {
                cleaver: {
                    1: { mas: 'C', menos: 'A' },
                    2: { mas: 'C', menos: 'A' },
                    3: { mas: 'D', menos: 'A' },
                    4: { mas: 'D', menos: 'C' },
                    5: { mas: 'D', menos: 'A' },
                    6: { mas: 'D', menos: 'A' },
                    7: { mas: 'D', menos: 'A' },
                    8: { mas: 'D', menos: 'C' },
                    9: { mas: 'D', menos: 'A' },
                    10: { mas: 'D', menos: 'A' }
                },
                kostick: {
                    1: 'D', 2: 'D', 3: 'D', 4: 'TD', 5: 'A',
                    6: 'TD', 7: 'TA', 8: 'D', 9: 'D', 10: 'TD',
                    11: 'A', 12: 'D', 13: 'A', 14: 'TD', 15: 'D'
                },
                situaciones: {
                    1: 'B', 2: 'A', 3: 'A', 4: 'B', 5: 'B'
                },
                aptitudes: {
                    1: '4', 2: '4', 3: '4', 4: '4',
                    5: '4', 6: '4', 7: '4', 8: '4',
                    9: '4', 10: '4', 11: '4', 12: '4'
                }
            };
            
            calcularYMostrar(respuestas, 'Candidato T√©cnico (Buenas aptitudes, mala actitud)');
        }

        // Usar datos reales del localStorage
        function probarDatosReales() {
            const datosGuardados = localStorage.getItem('evaluacion_psicometrica');
            if (!datosGuardados) {
                alert('No hay datos guardados en el navegador. Complete el test primero.');
                return;
            }
            
            const datos = JSON.parse(datosGuardados);
            const respuestas = {
                cleaver: datos.cleaver || {},
                kostick: datos.kostick || {},
                situaciones: datos.situaciones || {},
                aptitudes: datos.aptitudes || {}
            };
            
            calcularYMostrar(respuestas, 'Datos del Test Real (LocalStorage)');
        }

        // Funci√≥n principal para calcular y mostrar resultados
        function calcularYMostrar(respuestas, titulo) {
            const motor = new ScoringEngine(respuestas);
            const resultado = motor.calcular();
            const resumen = motor.generarResumenEjecutivo();
            
            mostrarResultados(resultado, resumen, titulo);
        }

        // Funci√≥n para mostrar los resultados en el DOM
        function mostrarResultados(resultado, resumen, titulo) {
            const contenedor = document.getElementById('resultado');
            
            let recomendacionClase = '';
            if (resultado.recomendacion === 'CONTRATAR') {
                recomendacionClase = 'contratar';
            } else if (resultado.recomendacion === 'RECHAZADO') {
                recomendacionClase = 'rechazado';
            } else {
                recomendacionClase = 'segunda-entrevista';
            }
            
            let html = `
                <div class="container resultado">
                    <h2>${titulo}</h2>
                    
                    <div class="recomendacion ${recomendacionClase}">
                        ${resultado.recomendacion.replace('_', ' ')}
                    </div>
                    
                    <div class="summary-grid">
                        <div class="summary-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <div class="label">Puntaje Total</div>
                            <div class="value">${resultado.puntajeTotal}</div>
                            <div class="label">de 122 puntos</div>
                        </div>
                        <div class="summary-item" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <div class="label">Porcentaje</div>
                            <div class="value">${resultado.porcentaje}%</div>
                            <div class="label">efectividad</div>
                        </div>
                        <div class="summary-item" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <div class="label">Perfil DISC</div>
                            <div class="value">${resultado.tipoDISC || 'N/A'}</div>
                            <div class="label">tipo dominante</div>
                        </div>
                        <div class="summary-item" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            <div class="label">Nivel de Riesgo</div>
                            <div class="value">${resultado.nivelRiesgo || 'N/A'}</div>
                            <div class="label">para contrataci√≥n</div>
                        </div>
                    </div>
                    
                    <h3>Perfil DISC</h3>
                    <div class="disc-profile">
                        <div class="disc-item">
                            <div class="letra">D</div>
                            <div class="valor">${resultado.perfilDISC.D}</div>
                            <div>Dominancia</div>
                        </div>
                        <div class="disc-item">
                            <div class="letra">I</div>
                            <div class="valor">${resultado.perfilDISC.I}</div>
                            <div>Influencia</div>
                        </div>
                        <div class="disc-item">
                            <div class="letra">S</div>
                            <div class="valor">${resultado.perfilDISC.S}</div>
                            <div>Estabilidad</div>
                        </div>
                        <div class="disc-item">
                            <div class="letra">C</div>
                            <div class="valor">${resultado.perfilDISC.C}</div>
                            <div>Cumplimiento</div>
                        </div>
                    </div>
                    
                    <h3>Puntajes por Secci√≥n</h3>
                    <div class="puntajes">
                        <div class="puntaje-item">
                            <div class="seccion">CLEAVER/DISC</div>
                            <div class="valor">${resultado.puntajes.cleaver.toFixed(1)}</div>
                            <div class="maximo">de ${ScoringEngine.PUNTAJES_MAXIMOS.cleaver} puntos</div>
                        </div>
                        <div class="puntaje-item">
                            <div class="seccion">KOSTICK</div>
                            <div class="valor">${resultado.puntajes.kostick.toFixed(1)}</div>
                            <div class="maximo">de ${ScoringEngine.PUNTAJES_MAXIMOS.kostick} puntos</div>
                        </div>
                        <div class="puntaje-item">
                            <div class="seccion">SITUACIONES</div>
                            <div class="valor">${resultado.puntajes.situaciones.toFixed(1)}</div>
                            <div class="maximo">de ${ScoringEngine.PUNTAJES_MAXIMOS.situaciones} puntos</div>
                        </div>
                        <div class="puntaje-item">
                            <div class="seccion">APTITUDES</div>
                            <div class="valor">${resultado.puntajes.aptitudes.toFixed(1)}</div>
                            <div class="maximo">de ${ScoringEngine.PUNTAJES_MAXIMOS.aptitudes} puntos</div>
                        </div>
                    </div>
            `;
            
            // Insights del perfil
            if (resultado.insightsDISC && resultado.insightsDISC.length > 0) {
                html += `
                    <div class="insights">
                        <h3>üí° Insights del Perfil</h3>
                        <ul>
                            ${resultado.insightsDISC.map(i => `<li>${i}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
            
            // Fortalezas y Debilidades
            if (resumen.fortalezas.length > 0 || resumen.debilidades.length > 0) {
                html += `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div class="insights" style="background: #d4edda; border-color: #28a745;">
                            <h3>‚úÖ Fortalezas</h3>
                            <ul>
                                ${resumen.fortalezas.map(f => `<li>${f}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="insights" style="background: #fff3cd; border-color: #ffc107;">
                            <h3>‚ö†Ô∏è √Åreas de Mejora</h3>
                            <ul>
                                ${resumen.debilidades.map(d => `<li>${d}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            }
            
            // Banderas rojas
            if (resultado.banderasRojas.length > 0) {
                html += `
                    <div class="banderas">
                        <h3>üö© Banderas Rojas (${resultado.banderasRojas.length})</h3>
                `;
                
                resultado.banderasRojas.forEach(bandera => {
                    html += `
                        <div class="bandera ${bandera.tipo.toLowerCase()}">
                            <strong>[${bandera.tipo}]</strong> 
                            ${bandera.seccion.toUpperCase()} - 
                            ${bandera.pregunta ? `Pregunta ${bandera.pregunta}: ` : ''}
                            ${bandera.descripcion}
                        </div>
                    `;
                });
                
                html += `</div>`;
            }
            
            // Mensaje final
            html += `
                    <div class="insights" style="margin-top: 20px;">
                        <h3>üìã Conclusi√≥n</h3>
                        <p><strong>${resultado.mensaje}</strong></p>
                    </div>
                </div>
            `;
            
            contenedor.innerHTML = html;
            contenedor.style.display = 'block';
            
            // Scroll hasta los resultados
            contenedor.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    </script>
</body>
</html>